<!DOCTYPE html>
<html>

<head>
    <title>Карта</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&amp;apikey=21031d1d-8e93-40cf-9871-743d3a9ad834"
        type="text/javascript"></script>
    <script src="icon_customImage.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Ваш CSS-код */
    </style>
    <link rel="stylesheet" href="map_styles.css">
    <!--Подключения для виджета чата-->
    <script src="dialog.js" defer></script>
    <script src="map.js" defer></script>
    <link rel="stylesheet" href="dialog_styles.css">
</head>

<body>
    <div id="map"></div>
    <!--Иконка чата -->
    <div class="chat-icon" onclick="toggleChat()">
        <img src="./images/chat.PNG" alt="Чат иконка">
    </div>
    <!--Плоскость виджета-->
    <div class="chat-widget" style="background-color: whitesmoke; display: none;">

        <!--Зона оглавления-->
        <!-- ... -->
        <!--Зона сообщений-->
        <!-- ... -->
        <!--Зона взаимодействия -->
        <div class="interaction-area" style="padding: 5px;">
            <div class="input-container">
                <input class=" message-input" type="text" id="dialog_input" placeholder="Введите ваше сообщение...">
                <button class="send-button" id="button_send_message"><img src="./images/send.PNG"
                        alt="Отправить сообщение"></button>
            </div>
        </div>
    </div>

    <div class="overlay" id="menu">


        <label for="latitude">Широта:</label>
        <input type="text" id="latitude" name="latitude"><br><br>
        <label for="longitude">Долгота:</label>
        <input type="text" id="longitude" name="longitude"><br><br>
        <label for="radius">Радиус:</label>
        <input type="text" id="radius" name="radius"><br><br>
        <label for="requiredServices">Необходимые услуги:</label>
        <input type="text" id="requiredServices" name="requiredServices"><br><br>
        <button class="submit-btn" onclick="submitData()">Отправить</button>
    </div>
    <div class="button">
        <button onclick="toggleMenu()">Меню</button>
    </div>

    <script>
        function toggleMenu() {
            var menu = document.getElementById("menu");
            menu.style.display = (menu.style.display === "block") ? "none" : "block";
            var button = document.querySelector('.button button');
            button.style.display = (button.style.display === "none") ? "block" : "none";
        }

        function toggleMenuButton() {
            var button = document.querySelector('.button button');
            button.innerText = (button.innerText === "Отобразить меню") ? "Скрыть меню" : "Отобразить меню";
            toggleMenu();
        }

        function toggleChat() {
            var chatWindow = document.querySelector('.chat-widget');
            chatWindow.style.display = (chatWindow.style.display === "block") ? "none" : "block";
        }

        async function sendGetRequest(latitude, longitude, radius, requiredServices) {
            const url = `http://0.0.0.0:5000/atm_filter?latitude=${latitude}&longitude=${longitude}&radius=${radius}&required=${requiredServices}`;

            try {
                const response = await fetch(url);
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Ошибка:', error);
            }
        }

        function submitData() {
            // Получаем значения из формы
            const latitude = document.getElementById("latitude").value;
            const longitude = document.getElementById("longitude").value;
            const radius = document.getElementById("radius").value;
            const requiredServices = document.getElementById("requiredServices").value;

            // Вызываем функцию sendGetRequest с полученными значениями
            sendGetRequest(latitude, longitude, radius, requiredServices)
                .then(data => {
                    console.log(data);
                })
                .catch(error => {
                    console.error(error);
                });
        }
    </script>

</body>

</html>